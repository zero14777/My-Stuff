head	1.1;
access;
symbols;
locks;
comment	@# @;


1.1
date	2013.10.24.21.28.58;	author -;	state -;
branches;
next	;


desc
@@


1.1
log
@-
@
text
@#!/usr/bin/perl
# $Id: pxref.perl,v 1.2 2013-10-11 19:24:18-07 - - $
use strict;
use warnings;

$0 =~ s|^.*/||;
my $exit_status = 0;
END {exit $exit_status}
sub note(@@) {print STDERR "@@_"};
$SIG{'__WARN__'} = sub {note @@_; $exit_status = 1};
$SIG{'__DIE__'} = sub {warn @@_; exit};

my $sep = ":" x 32;
push @@ARGV, "-" unless @@ARGV;

for my $filename (@@ARGV) {
   my %xref;
   open my $file, "<$filename"
        or warn "$0: $filename: $!\n" and next;
   while (defined (my $line = <$file>)) {
      push @@{$xref{$1}}, $.
           while $line =~ s|^.*?(\w+([-'.:/]\w+)*)||;
   }
   close $file;
   print "$sep\n$filename\n$sep\n";
   printf "%s [%d] %s\n", $_, @@{$xref{$_}} + 0,
          join " ", @@{$xref{$_}}
          for sort keys %xref;
}

@
